{% extends 'base.html' %}

{% block content %}
    <div class="card profile-header">
        <div class="profile-avatar">{{ user_obj.username|make_list|first|upper }}</div>
        <h2>{{ user_obj.username }}</h2>
        
        {% if user != user_obj %}
            <a href="{% url 'follow_unfollow' user_obj.username %}" style="text-decoration: none; display: inline-block; margin: 15px 0;">
                <button class="btn {% if is_following %}btn-secondary{% endif %}">
                    {% if is_following %}Unfollow{% else %}Follow{% endif %}
                </button>
            </a>
        {% endif %}
        
        <div class="profile-stats">
            <div class="stat">
                <div class="stat-number">{{ posts.count }}</div>
                <div class="stat-label">Posts</div>
            </div>
            <div class="stat">
                <div class="stat-number">{{ user_obj.profile.followers.count }}</div>
                <div class="stat-label">Followers</div>
            </div>
        </div>
    </div>

    <h3 style="margin: 20px 0;">User's Posts</h3>
    
    {% for post in posts %}
    <div class="card">
        <div class="post-header">
            <div class="avatar">{{ post.author.username|make_list|first|upper }}</div>
            <div>
                <a href="{% url 'profile' post.author.username %}" class="username">{{ post.author.username }}</a>
                <br>
                <small style="color: var(--text-light);">{{ post.created_at|timesince }} ago</small>
            </div>
        </div>
        
        <div class="post-content">{{ post.content }}</div>
        
        <div class="post-actions">
            <form action="{% url 'like_post' post.id %}" method="POST">
                {% csrf_token %}
                <button type="submit" class="like-btn {% if user in post.likes.all %}liked{% endif %}">
                    {% if user in post.likes.all %}Liked{% else %}Like{% endif %} ({{ post.total_likes }})
                </button>
            </form>
        </div>
    </div>
    {% empty %}
    <div class="card" style="text-align: center;">
        <h3 style="color: var(--text-light);">No posts yet!</h3>
    </div>
    {% endfor %}
{% endblock %}